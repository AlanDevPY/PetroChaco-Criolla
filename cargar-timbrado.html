<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargar Timbrado SET</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            text-align: center;
        }

        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        button {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 20px;
        }

        button:hover {
            background: #45a049;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }

        .data-preview {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
        }

        .data-preview div {
            margin: 5px 0;
        }

        .label {
            font-weight: bold;
            color: #495057;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üßæ Cargar Timbrado SET</h1>

        <div class="info">
            <strong>‚ÑπÔ∏è Informaci√≥n:</strong><br>
            Este script cargar√° autom√°ticamente los datos del timbrado oficial de la SET a Firebase.
        </div>

        <div class="data-preview">
            <h3>üìã Datos a cargar:</h3>
            <div><span class="label">N√∫mero de Timbrado:</span> 18426298</div>
            <div><span class="label">RUC:</span> 80094843-2</div>
            <div><span class="label">Raz√≥n Social:</span> GRUPO SANTA MARIA S.R.L.</div>
            <div><span class="label">Direcci√≥n:</span> RUTA PY 20 KM 17 ENTRADA PRINCIPAL A SANTIAGO</div>
            <div><span class="label">Vigencia:</span> 05/11/2025 - 30/11/2026</div>
            <div><span class="label">Establecimiento:</span> 002</div>
            <div><span class="label">Punto Expedici√≥n:</span> 002</div>
            <div><span class="label">Rango:</span> 0000001 - 0005000</div>
            <div><span class="label">Tipo:</span> FACTURA</div>
        </div>

        <button id="btnCargar" onclick="cargarTimbrado()">
            ‚úÖ Cargar Timbrado a Firebase
        </button>

        <div class="success" id="mensajeExito">
            <strong>‚úÖ ¬°√âxito!</strong><br>
            El timbrado se ha cargado correctamente a Firebase.
        </div>

        <div class="error" id="mensajeError">
            <strong>‚ùå Error:</strong><br>
            <span id="textoError"></span>
        </div>
    </div>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

        // Configuraci√≥n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCQsOTPjzFk7xZfZL8BiQ4fIDBXKPssBNw",
            authDomain: "petrochaco-criolla.firebaseapp.com",
            projectId: "petrochaco-criolla",
            storageBucket: "petrochaco-criolla.firebasestorage.app",
            messagingSenderId: "418269470247",
            appId: "1:418269470247:web:dc72b4ed57d98322027802"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Funci√≥n global para cargar el timbrado
        window.cargarTimbrado = async function () {
            const btn = document.getElementById('btnCargar');
            const mensajeExito = document.getElementById('mensajeExito');
            const mensajeError = document.getElementById('mensajeError');
            const textoError = document.getElementById('textoError');

            // Ocultar mensajes previos
            mensajeExito.style.display = 'none';
            mensajeError.style.display = 'none';

            // Deshabilitar bot√≥n
            btn.disabled = true;
            btn.textContent = '‚è≥ Cargando...';

            try {
                // Datos del timbrado
                const timbradoData = {
                    numeroTimbrado: "18426298",
                    rucEmpresa: "80094843-2",
                    razonSocial: "GRUPO SANTA MARIA S.R.L.",
                    direccionFiscal: "RUTA PY 20 KM 17 ENTRADA PRINCIPAL A SANTIAGO",
                    fechaInicio: "2025-11-05",
                    fechaVencimiento: "2026-11-30",
                    establecimiento: "002",
                    puntoExpedicion: "002",
                    rangoDesde: 1,
                    rangoHasta: 5000,
                    numeroActual: 1, // Comienza en el primer n√∫mero
                    observaciones: "Timbrado principal - FACTURA",
                    fechaCreacion: new Date().toISOString(),
                    activo: true
                };

                // Guardar en Firebase
                const docRef = await addDoc(collection(db, 'timbrados'), timbradoData);

                console.log("‚úÖ Timbrado cargado con ID:", docRef.id);

                // Mostrar mensaje de √©xito
                mensajeExito.style.display = 'block';
                btn.textContent = '‚úÖ Cargado Exitosamente';
                btn.style.background = '#28a745';

            } catch (error) {
                console.error("‚ùå Error al cargar timbrado:", error);

                // Mostrar mensaje de error
                textoError.textContent = error.message;
                mensajeError.style.display = 'block';

                // Rehabilitar bot√≥n
                btn.disabled = false;
                btn.textContent = 'üîÑ Reintentar';
            }
        };
    </script>
</body>

</html>